}
chisq.test(birth.freq,p=birth.prob)
birth.freq
birth.prob
birth.freq = as.array(c(66,63,64,48,64,74,70,59,54,51,45,42))
birth.prob <- as.array(rep(1,12))
birth.prob
birth.freq
for(i in 1:12){
birth.prob[i] = 1/12
}
birth.prob
chisq.test(birth.freq,p=birth.prob)
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv",header = T)
data
head(data)
attach(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv",header = T)
head(data)
attach(data)
..Location
1..Location
View(data)
View(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv",header = T)
head(data)
data <- read.csv2("data1.csv",header = T)
head(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv",header = T)
head(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv")
head(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.csv("data1.csv",header=F)
head(data)
attach(data)
V1
V1 <- V1[1:]
V1 <- V1[1:length(V1)]
V1
V1 <- V1[2:length(V1)]
V1 <- V1[2:length(V1)]
V1
data <- read.table("data.txt")
data
data <- read.table("data.txt",sep = ",")
data
data <- read.table("data.txt",sep = ",",header = T)
data
attach(data)
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.table("data.txt",sep = ",",header = T)
attach(data)
count
location
is.factor(location)
is.factor(factor)
library(Rmisc)
sum<-summarySE(data,measurevar="count",groupvars=c("location","factor"))
sum
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.table("data.txt",sep = "\t",header = T)
data
attach(data)
is.factor(location)
is.factor(factor)
library(Rmisc)
sum<-summarySE(data,measurevar="count",groupvars=c("location","factor"))
sum
aggregate(count~location*factor,FUN=var)
sum
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=location,y=count,color=factor))+
geom_errorbar(aes(ymin=count-se,ymax=count+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue"))
ggplot(sum,aes(x=location,y=count,color=factor))+
geom_errorbar(aes(ymin=count-se,ymax=count+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red"))
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=dose,y=len,color=supp))+
geom_errorbar(aes(ymin=len-se,ymax=len+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue"))
library(Rmisc)
sum<-summarySE(ToothGrowth,measurevar="len",groupvars=c("supp","dose"))
sum
aggregate(len~supp*dose,FUN=var)
library(ggplot2)
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=dose,y=len,color=supp))+
geom_errorbar(aes(ymin=len-se,ymax=len+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue"))
ggplot(sum,aes(x=location,y=count,color=factor))+
geom_errorbar(aes(ymin=count-se,ymax=count+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red"))
rm(list=ls())
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
data <- read.table("data.txt",sep = "\t",header = T)
attach(data)
is.factor(location)
is.factor(factor)
library(Rmisc)
sum<-summarySE(data,measurevar="count",groupvars=c("location","factor"))
sum
aggregate(count~location*factor,FUN=var)
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=location,y=count,color=factor))+
geom_errorbar(aes(ymin=count-se,ymax=count+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red"))
boxplot(count~location,data=data)
boxplot(count~factor,data=data)
fit<-aov(count~factor*location)
summary(fit)
?aov
interaction.plot(factor,location,count)
TukeyHSD(fit)
?TukeyHSD
fit1<-aov(count~location)
TukeyHSD(fit1)
TukeyHSD(fit1)
plot(TukeyHSD(fit))
fir
TukeyHSD(fit)
pairwise.t.test(count,factor)
pairwise.t.test(count,location)
?pairwise.t.test
rm(list=ls())
attach(ToothGrowth)
head(ToothGrowth)
summary(ToothGrowth)
is.factor(dose)
dose<-as.factor(dose)
is.factor(dose)
library(Rmisc)
sum<-summarySE(ToothGrowth,measurevar="len",groupvars=c("supp","dose"))
sum
aggregate(len~supp*dose,FUN=var)
library(ggplot2)
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=dose,y=len,color=supp))+
geom_errorbar(aes(ymin=len-se,ymax=len+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue"))
boxplot(len~supp,data=ToothGrowth)
boxplot(len~dose,data=ToothGrowth)
fit<-aov(len~supp*dose)
summary(fit) #or anova(fit)
interaction.plot(supp,dose,len)
dataOJ<-ToothGrowth[which(supp=="OJ"),]
dataVC<-ToothGrowth[which(supp=="VC"),]
anova(aov(len~dose,dataOJ))
anova(aov(len~dose,dataVC))
qqnorm(dataOJ$len)
qqnorm(dataVC$len)
data05<-ToothGrowth[which(dose=="0.5"),]
data10<-ToothGrowth[which(dose=="1"),]
data20<-ToothGrowth[which(dose=="2"),]
anova(aov(len~supp,data05))
anova(aov(len~supp,data10))
anova(aov(len~supp,data20))
qqnorm(data05)
qqnorm(data05$len)
qqnorm(data10$len)
qqnorm(data20$len)
head(mpg)
sapply(mpg,is.factor)
rm(list=ls())
data <- read.table("data.txt",sep = "\t",header = T)
attach(data)
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\two way anova")
is.factor(location)
is.factor(factor)
sum<-summarySE(data,measurevar="count",groupvars=c("location","factor"))
sum
library(Rmisc)
aggregate(count~location*factor,FUN=var)
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=location,y=count,color=factor))+
geom_errorbar(aes(ymin=count-se,ymax=count+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red"))
boxplot(count~location,data=data)
boxplot(count~factor,data=data)
fit<-aov(count~factor*location)
summary(fit)
interaction.plot(factor,location,count)
plot(TukeyHSD(fit))
fit1<-aov(count~location)
summary(fit1)
plot(TukeyHSD(fit1))
pairwise.t.test(count,location)
TukeyHSD(fit1)
pairwise.t.test(count,location,p.adjust.method = "bonf")
TukeyHSD(fit1)
fit2<-aov(count~factor)
plot(TukeyHSD(fit2))
summary(fit2)
rm(list=ls())
head(diamonds)
attach(diamonds)
is.factor(cut)
is.factor(clarity)
is.factor(color)
library(Rmisc)
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("cut","clarity","color"))
sum
aggregate(depth~cut*clairty*color,FUN=var)
aggregate(depth~cut*clarity*color,FUN=var)
depth[is.na(depth)] <- 0
is.factor(cut)
is.factor(clarity)
is.factor(color)
library(Rmisc)
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("cut","clarity","color"))
sum
aggregate(depth~cut*clarity*color,FUN=var)
boxplot(depth~cut,data=diamonds)
boxplot(depth~clarity,data=diamonds)
boxplot(depth~color,data=diamonds)
aggregate(depth~cut*clarity*color,FUN=var)
sapply(mpg,is.factor)
fit<-aov(depth~cut*color*clarity,diamonds)
summary(fit)
interaction.plot(cut,color,depth)
summary(fit)
interaction.plot(cut,color,clarity,depth)
interaction.plot(cut,clarity,depth)
interaction.plot(color,clarity,depth)
interaction.plot(cut,clarity,depth)
interaction.plot(color,clarity,depth)
interaction.plot(cut,color,depth)
interaction.plot(color,clarity,depth)
interaction.plot(cut,clarity,depth)
interaction.plot(cut,clarity,depth)
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("cut","clarity"))
library(ggplot2)
sum
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("cut","clarity"))
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=cut,y=depth,color=clarity))+
geom_errorbar(aes(ymin=depth-se,ymax=depth+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red"))
ggplot(sum,aes(x=cut,y=depth,color=clarity))+
geom_errorbar(aes(ymin=depth-se,ymax=depth+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red","yellow","green","violet","pink","lightblue"))
interaction.plot(color,clarity,depth)
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("color","clarity"))
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=color,y=depth,color=clarity))+
geom_errorbar(aes(ymin=depth-se,ymax=depth+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red","yellow","green","violet","pink","lightblue"))
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("color","cut"))
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=color,y=depth,color=cut))+
geom_errorbar(aes(ymin=depth-se,ymax=depth+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red","yellow","green","violet","pink","lightblue"))
interaction.plot(cut,color,depth)
sum<-summarySE(diamonds,measurevar="depth",groupvars=c("color","cut"))
library(ggplot2)
pd<-position_dodge(.2)
ggplot(sum,aes(x=color,y=depth,color=cut))+
geom_errorbar(aes(ymin=depth-se,ymax=depth+se),width=0.2,size=0.7,
position=pd)+
geom_point(shape=15,size=4,position=pd)+
theme_bw()+
theme(axis.title.y= element_text(vjust=1.8),
axis.title.x=element_text(vjust=-0.5),
axis.title = element_text(face="bold"))+
scale_color_manual(values=c("black","blue","red","yellow","green","violet","pink","lightblue"))
library(data.table)
data<-fread("http://data.princeton.edu/wws509/datasets/cuse.dat")
data
attach(data)
logreg<-glm(cbind(using,notUsing)~age+education+wantsMore,family=binomial)
summary(logreg)
1-pchisq(29.92,10)
logreg2<-glm(cbind(using,notUsing)~age*wantsMore+education,family=binomial)
summary(logreg2)
1-pchisq(12.63,7) ##can't reject the null hypothesis - conclude the model is
anova(logreg,logreg2)
plot(logreg2$residuals)
logreg2$fitted
logreg3<-glm(cbind(using,notUsing)~age*wantsMore+education,
family=quasibinomial)
summary(logreg3)
attach(warpbreaks)
head(warpbreaks)
mean(breaks)
var(breaks)
fit<-glm(breaks~wool+tension,family=poisson)
summary(fit)
1-pchisq(210.39,50)##model is not adequate
fit2<-glm(breaks~wool*tension,family=poisson)
summary(fit2)
fit3<-glm(breaks~wool*tension, family=quasipoisson)
summary(fit3)
out<-data.frame(breaks,pred1=fit$fitted,pred2=fit2$fitted)
out
install.packages("geepack")
library(geepack)
data(ohio)
head(ohio)
summary(ohio)
fit.exch <- geeglm(resp~age+smoke,family=binomial(link="logit"),data=ohio,id=id,corstr="exchangeable")
summary(fit.exch)
setwd("C:\\Users\\aungkon\\Desktop\\stat\\assignment\\generalized linear model")
install.packages(“glm2”)
install.packages("glm2”)
library(glm2)
data(crabs)
data(heads)
install.packages("glm2”)
library(glm2)
data(crabs)
data(heads)
install.packages("glm2")
data(crabs)
library(glm2)
data(crabs)
attach(crabs)
head(crabs)
rm(list=ls())
library(data.table)
data<-fread("http://data.princeton.edu/wws509/datasets/cuse.dat")
data
attach(data)
logreg<-glm(cbind(using,notUsing)~age+education+wantsMore,family=binomial)
using
notUsing
cbind(using,notUsing)
head(crabs)
Satellites
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson)
summary(logreg)
logreg<-glm(as.factor(Satellites)~Width+Dark+GoodSpine,family=poisson)
head(crabs)
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson)
summary(logreg)
logreg<-glm(Satellites~Width*Dark*GoodSpine,family=poisson)
summary(logreg)
logreg<-glm(Satellites~Width*Dark*GoodSpine,family=quasipoisson)
summary(logreg)
is.factor(Width)
Width
is.factor(Dark)
is.factor(GoodSpine)
logreg<-glm(as.factor(Satellites)~Width*Dark*GoodSpine,family=quasipoisson)
as.factor(Satellites)
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson)
summary(logreg)
1-pchisq(560.96,196)
logreg1<-glm(Satellites~Width*Dark*GoodSpine,family=poisson)
summary(logreg1)
1-pchisq(560.96,169)
1-pchisq(549.49,165)
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson,link="canonical")
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson(link="canonical"))
logreg<-glm(Satellites~Width+Dark+GoodSpine,family=poisson(link=canonical))
logreg2<-glm(Satellites~Width*Dark,family=poisson)
summary(logreg2)
1-pchisq(555.42,169)
logreg3<-glm(Satellites~Width*Dark*GoodSpine,family=quasipoisson)
summary(logreg3)
plot(logreg3$residuals)
rm(list=ls())
data(heart)
head(heart)
attach(heart)
is.factor(AgeGroup)
AgeGroup
is.factor(Severity)
Severity
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=binomial)
summary(logreg)
1-pchisq(113.11,65)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)*as.factor(Severity)*as.factor(Region),family=binomial)
summary(logreg)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=poisson)
summary(logreg)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=poisson)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=binomial)
summary(logreg)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)*as.factor(Severity)*as.factor(Region),family=binomial)
logreg1<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)*as.factor(Severity)*as.factor(Region),family=binomial)
summary(logreg)
summary(logreg1)
1-pchisq(2.7229e-10,0)
logreg2<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=binomial)
summary(logreg2)
1-pchisq(97.567,61)
?glm
logreg2<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=Gamma)
cbind(Deaths,Patients-Deaths)
logreg3<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Severity)+as.factor(Region),family=binomial)
summary(logreg3)
logreg4<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Severity)*as.factor(Region),family=binomial)
summary(logreg4)
1-pchisq(70.897,49)
logreg4<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Severity)*as.factor(Region)+as.factor(Delay),family=binomial)
summary(logreg4)
1-pchisq(62.885,47)
plot(logreg4$residuals)
logreg<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)+as.factor(Delay)+as.factor(Severity)+as.factor(Region),family=binomial(link=probit))
summary(logreg)
1-pchisq(98.546,65)
logreg1<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)*as.factor(Severity)*as.factor(Region),family=binomial(link=probit))
summary(logreg1)
logreg1<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Delay)*as.factor(Region)+as.factor(Severity),family=binomial(link=probit))
summary(logreg1)
1-pchisq(63.036,45)
(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Region)+as.factor(Severity)*as.factor(Delay),family=binomial(link=probit))
logreg1<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Region)+as.factor(Severity)*as.factor(Delay),family=binomial(link=probit))
summary(logreg1)
logreg1<-glm(cbind(Deaths,Patients-Deaths)~as.factor(AgeGroup)*as.factor(Region)*as.factor(Severity)+as.factor(Delay),family=binomial(link=probit))
summary(logreg1)
1-pchisq(63.29,47)
plot(logreg1$residuals)
